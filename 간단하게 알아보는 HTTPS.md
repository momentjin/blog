# 간단하게 알아보는 HTTPS

> HTTPS, TLS, SSL, 인증서, 개인키, 공개키 등 개발자라면 한 번쯤은 접했을 법한 용어들입니다. 그럼에도 불구하고 저는 이 용어들에 대해 자신있게 설명할 수 없습니다. 이번 포스팅을 통해 머릿속에 흩어져 있는 지식들을 깔끔하게 정리하고 제 것으로 만들고자 합니다.


## HTTPS?
HTTPS는 우리가 흔히 알고 있는 Http 프로토콜에 보안 기능을 추가한 프로토콜입니다.

HTTPS는 HTTP over SSL, HTTP over TLS, HTTP Secure의 약자입니다.


## HTTPS가 필요한 이유
새로운 기술에는 반드시 그 기술이 나오게 된 동기가 있습니다. HTTPS가 등장한 이유는 HTTP 프로토콜에는 보안 기능이 없기 때문입니다. 상세하게 살펴보면 아래와 같습니다.

#### 도청의 위험
통신 데이터를 중간에 훔쳐볼 수 있습니다.

#### 위장의 위험
HTTP는 통신 상대를 확인하지 않습니다. 누가 요청했고 응답했는지, 통신하고자 하는 상대가 의도한 상대가 맞는지 알 수 없습니다.

#### 변조의 위험
서버와 클라이언트 사이의 통신 중 데이터가 변조될 수 있습니다. 송신 데이터와 수신 데이터가 100% 일치한다고 보장할 수 없습니다.


## HTTPS가 보안을 책임지는 방식
위에서 언급한 HTTP의 3가지 단점을 HTTPS는 어떻게 극복했는지 알아보겠습니다.

HTTPS는 통신할 때 기본적으로 암호화를 사용해서 데이터가 유출되지 않도록 보호합니다. 이 때 사용되는 암호화 방식이 하이브리드(공통키+공개키) 암호화 방식입니다. 

하이브리드 암호화 방식을 사용하는 이유는 공통키, 공개키 방식 암호화의 약점이 있기 때문입니다.

***공통키 암호화의 약점***

공통키 방식은 암복호화할 때 사용하는 키가 같은 암호화 방식입니다. A가 암호화를 했으면, B는 복호화를 해야합니다. 따라서 A와 B는 키 공유를 해야합니다. 이 때 키를 전달하기 위해서 네트워크를 이용할 수 밖에 없습니다. 이는 키가 유출될 수 있다는 잠재적인 위험과도 같습니다. 

***공개키 암호화의 약점***

공개키 방식은 공통키 방식의 단점을 극복하기 위해 만들어진 암호화 방식입니다. 누구나 알아도 되는 공개키를 이용해 암호화하고, 유일하게 이를 복호화할 수 있는 비밀키를 통해 복호화를 합니다. 따라서 비밀키는 네트워크를 통해 송수신하지 않으므로 유출의 위험이 훨씬 적습니다.

이 방식의 약점은 공통키 방식에 비해 공개키 방식의 처리속도가 현저히 늦다는 것입니다. ~~얼마나, 왜 느린지 궁금하지만 다음에 제대로 다뤄보아야 겠습니다.~~ 

***하이브리드 암호화***

HTTPS는 공개키 암호화 방식의 단점을 극복하기 위해 하이브리드 방식을 사용합니다. 우선 데이터를 암복호화하기 위한 `공통키`는 `공개키 암호화 방식`을 사용해서 네트워크를 통해 전달합니다. 이제 클라이언트와 서버는 각각 갖고 있는 `공통키`를 통해 데이터를 빠르게 암복호화하며 통신하는게 가능해집니다. 하지만.. 하이브리드 암호화 역시 약점이 존재합니다.

하이브리드 방식의 약점은, 더 정확하게 말하면 공개키 방식의 단점은 공개키가 진짜인지 확인할 방법이 없다는 것입니다. 가령, 피싱 사이트에서 클라이언트에게 `공개키`를 발급했고, 클라이언트가 `공개키`를 사용해서 암호화한 데이터를 피싱 사이트로 보냈다고 칩시다. 피싱 사이트는 암호화된 데이터를 자신의 비밀키로 복호화하면 끝입니다. 이러한 딜레마를 극복하기 위해 인증이라는 것을 도입했습니다.

#### 인증
인증이란, 통신하고자 하는 상대가 진짜 그 상대가 맞는지 확인하는 것을 말합니다. 공개키 방식을 통해 전자서명을 하고, 이는 인증기관이 담당합니다. 인증을 통해 어떻게 통신 상대를 신뢰할 수 있는지 간단히 살펴보겠습니다.

1. (사전에) 서버는 인증기관에 자신의 공개키를 등록하고, 인증기관은 인증기관의 비밀키를 이용해 서버의 공개키에 서명하여 증명서를 등록합니다.
2. 클라이언트는 브라우저에 존재하는 인증기관의 공개키를 사용해 암호화된 증명서를 복호화합니다. (복호화가 성공한다는 것은 인증기관의 비밀키로 암호화 되었다는 것을 뜻한다. 즉, 신원보장이 되는 셈이다.)
3. 클라이언트는 공개키를 신뢰할 수 있으므로, 공개키로 데이터를 암호화해서 서버로 전달합니다.
4. 서버는 자신의 비밀키로 전달받은 데이터를 복호화합니다.

이렇게 신원을 보장해주는 대리자가 인증기관입니다. 하지만, 인증기관 역시 신뢰할 수 있는 기관이어야 합니다. 참 아이러니하네요.

---

## 참고

- 그림으로 배우는 Http & Network Basic
- TCP/IP 쉽게 더쉽게